<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cyberpunk AI Student Services Chatbot</title>

  <style>
    :root{
      --bg:#05030a;
      --bg2:#070a18;
      --glass: rgba(10, 12, 28, .55);
      --glass2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.62);

      --neonA:#00e5ff;   /* cyan */
      --neonB:#ff2bd6;   /* magenta */
      --neonC:#7c4dff;   /* violet */
      --neonG:#39ff14;   /* neon green */

      --shadow: 0 25px 80px rgba(0,0,0,.65);
      --radius: 18px;
      --radius2: 14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(0,229,255,.18), transparent 60%),
        radial-gradient(900px 600px at 85% 15%, rgba(255,43,214,.16), transparent 58%),
        radial-gradient(900px 700px at 50% 95%, rgba(124,77,255,.14), transparent 62%),
        linear-gradient(160deg, var(--bg), var(--bg2));
      overflow:hidden;
    }

    /* --- Animated cyber grid --- */
    .grid{
      position:fixed; inset:-30%;
      background-image:
        linear-gradient(rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size: 56px 56px;
      transform: rotate(12deg);
      opacity:.35;
      animation: gridMove 18s linear infinite;
      pointer-events:none;
      filter: blur(.1px);
    }
    @keyframes gridMove{
      0%{ background-position: 0 0, 0 0; }
      100%{ background-position: 560px 0, 0 560px; }
    }

    /* --- Scanlines overlay --- */
    .scanlines{
      position:fixed; inset:0;
      background: repeating-linear-gradient(
        to bottom,
        rgba(255,255,255,.05),
        rgba(255,255,255,.05) 1px,
        rgba(0,0,0,0) 3px,
        rgba(0,0,0,0) 7px
      );
      opacity:.15;
      mix-blend-mode: overlay;
      pointer-events:none;
    }

    /* --- Floating neon orbs --- */
    .orb{
      position:fixed; border-radius:999px;
      filter: blur(30px);
      opacity:.20;
      pointer-events:none;
      animation: float 10s ease-in-out infinite;
    }
    .orb.o1{ width:340px; height:340px; left:-90px; top:110px; background:rgba(0,229,255,.8); }
    .orb.o2{ width:320px; height:320px; right:-120px; top:120px; background:rgba(255,43,214,.75); animation-duration:12s;}
    .orb.o3{ width:380px; height:380px; left:35%; bottom:-160px; background:rgba(124,77,255,.75); animation-duration:14s;}
    @keyframes float{
      0%,100%{ transform: translateY(0) translateX(0) scale(1); }
      50%{ transform: translateY(-24px) translateX(14px) scale(1.05); }
    }

    /* --- App Layout --- */
    .wrap{
      position:relative;
      z-index:2;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .app{
      width:min(1020px, 100%);
      height:min(740px, 92vh);
      display:grid;
      grid-template-columns: 330px 1fr;
      gap:16px;
    }

    /* --- Left Info Panel --- */
    .panel{
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .panel:before{
      content:"";
      position:absolute; inset:-2px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(0,229,255,.35), rgba(255,43,214,.28), rgba(124,77,255,.25));
      filter: blur(18px);
      opacity:.35;
      z-index:0;
    }
    .panelInner{
      position:relative;
      z-index:1;
      height:100%;
      display:flex;
      flex-direction:column;
    }
    .pTop{
      padding:18px 18px 14px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo{
      width:42px; height:42px;
      border-radius:14px;
      background:
        radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.45), transparent 60%),
        linear-gradient(135deg, rgba(0,229,255,.95), rgba(255,43,214,.85));
      box-shadow: 0 0 30px rgba(0,229,255,.25);
      position:relative;
      flex:0 0 auto;
    }
    .logo:after{
      content:"";
      position:absolute; inset:10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.25);
      opacity:.7;
    }
    .pTitle{
      line-height:1.1;
    }
    .pTitle h1{
      margin:0;
      font-size:15px;
      letter-spacing:.3px;
    }
    .pTitle p{
      margin:5px 0 0;
      font-size:12px;
      color: var(--muted);
      font-family: var(--mono);
    }
    .live{
      margin-left:auto;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(57,255,20,.35);
      background: rgba(57,255,20,.10);
      color: rgba(230,255,230,.95);
      display:flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 0 24px rgba(57,255,20,.15);
      flex:0 0 auto;
    }
    .liveDot{
      width:8px; height:8px;
      border-radius:999px;
      background: var(--neonG);
      box-shadow: 0 0 14px rgba(57,255,20,.75);
      animation: pulse 1.4s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform: scale(1); opacity:.8;}
      50%{ transform: scale(1.35); opacity:1;}
    }

    .pBody{
      padding:16px 18px;
      display:flex;
      flex-direction:column;
      gap:14px;
      height:100%;
    }
    .card{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius: var(--radius2);
      padding:14px;
    }
    .card h3{
      margin:0 0 8px;
      font-size:13px;
      letter-spacing:.2px;
    }
    .card p{
      margin:0;
      font-size:12.5px;
      color: var(--muted);
      line-height:1.45;
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .chip{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.86);
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      cursor:pointer;
      transition: transform .15s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
      user-select:none;
    }
    .chip:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.20);
      box-shadow: 0 0 18px rgba(0,229,255,.10);
    }
    .footerMeta{
      margin-top:auto;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      color: rgba(255,255,255,.55);
      font-size:11px;
      font-family: var(--mono);
    }
    .pill{
      padding:6px 9px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    /* --- Chat Panel --- */
    .chat{
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      position:relative;
    }
    .chat:before{
      content:"";
      position:absolute; inset:-2px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(0,229,255,.30), rgba(255,43,214,.22), rgba(124,77,255,.18));
      filter: blur(18px);
      opacity:.25;
      z-index:0;
      pointer-events:none;
    }

    .chatHeader{
      position:relative;
      z-index:1;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; gap:10px;
    }
    .chatHeader .hTitle{
      display:flex; flex-direction:column;
      line-height:1.1;
    }
    .chatHeader strong{
      font-size:14px;
      letter-spacing:.2px;
    }
    .chatHeader span{
      font-size:12px;
      color: var(--muted);
      font-family: var(--mono);
    }
    .spark{
      margin-left:auto;
      display:flex; gap:8px;
    }
    .spark i{
      width:10px; height:10px; border-radius:999px; display:inline-block;
      background: rgba(255,255,255,.18);
    }
    .spark i:nth-child(1){ background: rgba(0,229,255,.55); }
    .spark i:nth-child(2){ background: rgba(57,255,20,.45); }
    .spark i:nth-child(3){ background: rgba(255,43,214,.45); }

    .msgs{
      position:relative;
      z-index:1;
      padding:18px;
      overflow:auto;
      flex:1;
      scroll-behavior:smooth;
    }
    .msgs::-webkit-scrollbar{ width:10px; }
    .msgs::-webkit-scrollbar-thumb{
      background: rgba(255,255,255,.12);
      border-radius:999px;
      border:2px solid rgba(0,0,0,.25);
    }

    .row{
      display:flex;
      margin:10px 0;
    }
    .row.user{ justify-content:flex-end; }
    .row.bot{ justify-content:flex-start; }

    .bubble{
      max-width: min(560px, 86%);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 16px;
      padding:12px 12px;
      background: rgba(0,0,0,.22);
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
      position:relative;
      overflow:hidden;
    }
    .row.user .bubble{
      background: linear-gradient(135deg, rgba(0,229,255,.14), rgba(255,43,214,.12));
      border-color: rgba(0,229,255,.22);
    }
    .row.bot .bubble{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.12);
    }

    .who{
      font-size:11px;
      color: rgba(255,255,255,.70);
      margin-bottom:6px;
      display:flex;
      align-items:center;
      gap:8px;
      font-family: var(--mono);
    }
    .tag{
      font-size:10px;
      padding:4px 7px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.78);
      letter-spacing:.2px;
      text-transform: uppercase;
    }
    .txt{
      font-size:13.5px;
      line-height:1.45;
      color: rgba(255,255,255,.92);
      white-space:pre-wrap;
      word-wrap:break-word;
    }

    /* --- Typing dots --- */
    .typingDots{
      display:inline-flex; gap:6px; align-items:center;
      padding:6px 2px 0;
    }
    .typingDots span{
      width:7px; height:7px; border-radius:999px;
      background: rgba(255,255,255,.55);
      animation: bounce 1.2s infinite ease-in-out;
      opacity:.7;
    }
    .typingDots span:nth-child(2){ animation-delay:.15s; }
    .typingDots span:nth-child(3){ animation-delay:.30s; }
    @keyframes bounce{
      0%,80%,100%{ transform: translateY(0); opacity:.5; }
      40%{ transform: translateY(-6px); opacity:1; }
    }

    /* --- Composer --- */
    .composer{
      position:relative;
      z-index:1;
      padding:14px 16px;
      border-top:1px solid rgba(255,255,255,.10);
      display:flex;
      gap:10px;
      align-items:center;
      background: rgba(0,0,0,.12);
    }
    .inputWrap{
      flex:1;
      display:flex;
      align-items:center;
      gap:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      border-radius: 14px;
      padding:10px 12px;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    .inputWrap:focus-within{
      border-color: rgba(0,229,255,.35);
      box-shadow: 0 0 0 4px rgba(0,229,255,.12);
    }
    .prompt{
      font-family: var(--mono);
      font-size:12px;
      color: rgba(255,255,255,.55);
      user-select:none;
    }
    input{
      border:0;
      outline:0;
      background: transparent;
      color: rgba(255,255,255,.92);
      width:100%;
      font-size:13.5px;
    }
    input::placeholder{ color: rgba(255,255,255,.45); }

    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(135deg, rgba(0,229,255,.22), rgba(255,43,214,.18));
      color: rgba(255,255,255,.92);
      padding: 11px 14px;
      border-radius: 14px;
      font-weight:700;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
      min-width: 112px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      position:relative;
      overflow:hidden;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.06); box-shadow: 0 0 24px rgba(0,229,255,.10); }
    .btn:active{ transform: translateY(0); }
    .btn[disabled]{ opacity:.65; cursor:not-allowed; transform:none; box-shadow:none; }

    .spinner{
      width:16px; height:16px;
      border-radius:999px;
      border:2px solid rgba(255,255,255,.35);
      border-top-color: rgba(255,255,255,.95);
      animation: spin .85s linear infinite;
      display:none;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    /* --- Responsive --- */
    @media (max-width: 920px){
      .app{ grid-template-columns: 1fr; height: 92vh; }
      .panel{ display:none; }
    }
  </style>
</head>

<body>
  <div class="grid"></div>
  <div class="scanlines"></div>
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="orb o3"></div>

  <div class="wrap">
    <div class="app">
      <!-- Left panel -->
      <aside class="panel">
        <div class="panelInner">
          <div class="pTop">
            <div class="logo"></div>
            <div class="pTitle">
              <h1>Cyberpunk Student AI</h1>
              <p>aws://serverless/chat</p>
            </div>
            <div class="live"><span class="liveDot"></span> LIVE</div>
          </div>

          <div class="pBody">
            <div class="card">
              <h3>Quick prompts</h3>
              <p>Click a prompt to send instantly.</p>
              <div class="chips" id="chips">
                <div class="chip">what programs do you offer</div>
                <div class="chip">how do i register</div>
                <div class="chip">what support services are available</div>
                <div class="chip">hi</div>
              </div>
            </div>

            <div class="card">
              <h3>Cyber tips</h3>
              <p>
                This UI has neon glow, animated grid, scanlines, typing dots, and a loading spinner.
                Itâ€™s one file: just upload <b>index.html</b> to S3.
              </p>
            </div>

            <div class="footerMeta">
              <div class="pill">UI: cyberpunk</div>
              <div class="pill">UX: typing + spinner</div>
              <div class="pill">AWS: API â†’ Lambda</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Chat -->
      <main class="chat">
        <div class="chatHeader">
          <div class="logo" style="width:34px;height:34px;border-radius:12px;"></div>
          <div class="hTitle">
            <strong>AI Student Services Chatbot</strong>
            <span id="statusText">Ready</span>
          </div>
          <div class="spark" aria-hidden="true"><i></i><i></i><i></i></div>
        </div>

        <div class="msgs" id="msgs"></div>

        <div class="composer">
          <div class="inputWrap">
            <span class="prompt">â€º</span>
            <input id="msgInput" placeholder="Ask about programs, registration, supportâ€¦ (press Enter)" />
          </div>
          <button class="btn" id="sendBtn">
            <div class="spinner" id="btnSpinner"></div>
            <span id="btnText">Send</span>
          </button>
        </div>
      </main>
    </div>
  </div>

  <script>
    // âœ… Your real API Gateway endpoint (must include /chat)
    const API_URL = "https://utjwn2p1h2.execute-api.ca-central-1.amazonaws.com/chat";

    const msgsEl = document.getElementById("msgs");
    const inputEl = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");
    const btnSpinner = document.getElementById("btnSpinner");
    const btnText = document.getElementById("btnText");
    const statusText = document.getElementById("statusText");

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;");
    }

    function addMessage(role, text){
      const row = document.createElement("div");
      row.className = "row " + role;

      const bubble = document.createElement("div");
      bubble.className = "bubble";

      const who = document.createElement("div");
      who.className = "who";
      who.innerHTML = role === "user"
        ? `<span class="tag">You</span><span>user</span>`
        : `<span class="tag">Bot</span><span>assistant</span>`;

      const txt = document.createElement("div");
      txt.className = "txt";
      txt.innerHTML = escapeHtml(text);

      bubble.appendChild(who);
      bubble.appendChild(txt);
      row.appendChild(bubble);
      msgsEl.appendChild(row);
      msgsEl.scrollTop = msgsEl.scrollHeight;
    }

    let typingRow = null;
    function showTyping(){
      if(typingRow) return;
      const row = document.createElement("div");
      row.className = "row bot";
      const bubble = document.createElement("div");
      bubble.className = "bubble";
      const who = document.createElement("div");
      who.className = "who";
      who.innerHTML = `<span class="tag">Bot</span><span>thinking</span>`;
      const txt = document.createElement("div");
      txt.className = "txt";
      txt.innerHTML = `<span class="typingDots"><span></span><span></span><span></span></span>`;
      bubble.appendChild(who);
      bubble.appendChild(txt);
      row.appendChild(bubble);
      msgsEl.appendChild(row);
      msgsEl.scrollTop = msgsEl.scrollHeight;
      typingRow = row;
    }

    function hideTyping(){
      if(typingRow){
        typingRow.remove();
        typingRow = null;
      }
    }

    function setLoading(isLoading){
      sendBtn.disabled = isLoading;
      btnSpinner.style.display = isLoading ? "inline-block" : "none";
      btnText.textContent = isLoading ? "Sending" : "Send";
      statusText.textContent = isLoading ? "Contacting AWSâ€¦" : "Ready";
      inputEl.disabled = isLoading;
    }

    async function callApi(message){
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      });

      const data = await res.json().catch(() => ({}));
      if(!res.ok){
        const msg = (data && (data.message || data.error || data.errorMessage)) ? (data.message || data.error || data.errorMessage) : "Request failed";
        throw new Error(`HTTP ${res.status}: ${msg}`);
      }

      // Support proxy format { body: "..." }
      if(data && typeof data.body === "string"){
        try { return JSON.parse(data.body); } catch(e){ return { reply: data.body }; }
      }
      return data;
    }

    async function sendMessage(text){
      const msg = (text ?? inputEl.value ?? "").trim();
      if(!msg) return;

      addMessage("user", msg);
      inputEl.value = "";

      setLoading(true);
      showTyping();

      try{
        const payload = await callApi(msg);
        const reply = payload && payload.reply ? String(payload.reply) : "No reply returned.";
        hideTyping();
        addMessage("bot", reply);
      }catch(err){
        hideTyping();
        addMessage("bot", "Error calling API.\n" + err.message);
      }finally{
        setLoading(false);
        inputEl.focus();
      }
    }

    // Button + Enter
    sendBtn.addEventListener("click", () => sendMessage());
    inputEl.addEventListener("keydown", (e) => {
      if(e.key === "Enter"){
        e.preventDefault();
        sendMessage();
      }
    });

    // Quick chips
    const chips = document.getElementById("chips");
    if(chips){
      chips.addEventListener("click", (e) => {
        const chip = e.target.closest(".chip");
        if(!chip) return;
        sendMessage(chip.textContent);
      });
    }

    // Welcome
    addMessage("bot",
      "Welcome ðŸ‘‹\nAsk me about:\nâ€¢ Programs\nâ€¢ Registration\nâ€¢ Support Services\n\nTry a quick prompt on the left, or type your own."
    );
  </script>
</body>
</html>